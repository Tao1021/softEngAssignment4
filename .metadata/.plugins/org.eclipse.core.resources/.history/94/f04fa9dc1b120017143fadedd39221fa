'''
Created on 26 Mar 2017

@author: minogud2
'''
import sqlite3 as lt
import time
import datetime
import requests

def get_Data(url):
    data = requests.get(url).json()
    unix = time.time()
    date = str(datetime.datetime.fromtimestamp(unix).strftime('%Y-%m%-d %H: %M: %S'))
    
    temp = data['main']['temp']
    weather_id = data['weather'][0]['id']
    sunrise = data['sys']['sunrise']
    sunset = data['sys']['sunset']
    
    cur.execute("INSERT INTO weather(unix, temp, temp INT, desc TEXT, icon TEXT)")
        
    con.commit()

    return [temp, weather_id, sunrise, sunset]

    
if __name__ == '__main__':
    try:
        con = lt.connect('dublin_BikesRDB.db')
        cur = con.cursor()
        url='http://api.openweathermap.org/data/2.5/weather?id=2964574&APPID=33e340fbba76a4645e26160abb37f014&units=metric'
        DB_PATH = ''
    finally:
        cur.close()
        con.close()